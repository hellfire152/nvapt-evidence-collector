ICMP:
  # numbers here are not ports, but the ICMP message type
  13: # timestamp request
    - "hping3 -c 5 --icmp --icmp-ts -V {%HOST%} > {%FOLDER%}/{%HOST%}-icmp-timestamp.txt 2>/dev/null"
    
TCP:
  22:
    - "nmap --script ssh2-enum-algos -p22 {%HOST%} > {%FOLDER%}/{%HOST%}-p22-nmap-ssh2-enum-algos.txt"
  445:
    - "nmap -–script smb2-security-mode -p445 {%HOST%} > {%FOLDER%}/{%HOST%}-p445-nmap-smb2-security-mode.txt"
  3389:
    - "nmap -–script rdp-ntlm-info -p3389 {%HOST%} > {%FOLDER%}/{%HOST%}-p3389-nmap-rdp-ntlm-info.txt"
    - "nmap -–script rdp-enum-encryption -p3389 {%HOST%} > {%FOLDER%}/{%HOST%}-p3389-nmap-rdp-enum-encryption.txt"

# as UDP is connectionless, connectivity check is not performed before executing the commands
UDP:
  161:
    - "nmap -sU -sV -p 161 -Pn {%HOST%} > {%FOLDER%}/{%HOST%}-p161-nmap.txt"
  2638:
    - "nmap -sU -p 2638 --script broadcast-sybase-asa-discover -Pn {%HOST%} > {%FOLDER%}/{%HOST%}-p2638-nmap-broadcast-sybase-asa-discover.txt"
  5353:
    - "nmap -sC -sU -p5353 -Pn {%HOST%} > {%FOLDER%}/{%HOST%}-p5353-nmap.txt"

# when 'Plugin Output' found 'cipher'
TLS:
  - "sslscan --no-failed {%HOST%}:{%PORT%} > {%FOLDER%}/{%HOST%}-{%PORT%}-sslscan--no-failed.txt"
  - "nmap --script ssl-enum-ciphers -p {%PORT%} {%HOST%} > {%FOLDER%}/{%HOST%}-{%PORT%}-nmap-ssl-enum-ciphers.txt"
  - "nmap --script ssl-cert -p {%PORT%} {%HOST%} > {%FOLDER%}/{%HOST%}-{%PORT%}-nmap-ssl-cert.txt"
  - "msfconsole -q -x \"use auxiliary/scanner/http/cert; set RHOSTS {%HOST%}; set RPORT {%PORT%}; set SHOWALL true; spool {%FOLDER%}/{%HOST%}-{%PORT%}-msf-auxiliary-scanner-http-cert.txt; run; spool off; quit;\""

# when 'Plugin Output' found 'The remote web server type is'
# all commands for web server assume HTTP instead
# as the script will replace it to HTTPS if the affected service is found with TLS
WEB:
  - "curl -k -I http://{%HOST%}:{%PORT%}/ > {%FOLDER%}/{%HOST%}-{%PORT%}-curl-get-response-headers.txt"
  - "curl -k -L http://{%HOST%}:{%PORT%}/ > {%FOLDER%}/{%HOST%}-{%PORT%}-curl-follow-redirects.txt"
